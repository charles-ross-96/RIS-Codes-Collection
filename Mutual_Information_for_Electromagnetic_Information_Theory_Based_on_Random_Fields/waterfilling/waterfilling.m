close all

x = -5:0.05:5;
y=[0.0130572,0.0135268,0.0140112,0.0145107,0.0150255,0.015556,0.0161024,0.0166652,0.0172445,0.0178407,0.0184541,0.0190849,0.0197334,0.0203997,0.0210841,0.0217869,0.0225081,0.0232479,0.0240064,0.0247838,0.02558,0.026395,0.0272289,0.0280815,0.0289526,0.0298422,0.0307499,0.0316754,0.0326183,0.033578,0.0345542,0.0355459,0.0365526,0.0375732,0.0386067,0.039652,0.0407078,0.0417726,0.0428447,0.0439223,0.0450032,0.0460853,0.047166,0.0482423,0.0493113,0.0503693,0.0514127,0.0524371,0.0534379,0.0544098,0.0553471,0.0562434,0.0570918,0.0578843,0.0586121,0.0592657,0.059834,0.0603048,0.0606642,0.0608966,0.0609841,0.0609061,0.0606387,0.0601541,0.0594192,0.0583943,0.0570307,0.0552678,0.0530278,0.0502075,0.0466643,0.0421891,0.0364485,0.0288368,0.0179387,0.00560381,0.032304,0.0527346,0.0703312,0.0860026,0.100183,0.113126,0.124997,0.135915,0.145964,0.155211,0.163707,0.171494,0.178607,0.185072,0.190913,0.196149,0.200796,0.204869,0.208377,0.211332,0.213739,0.215605,0.216935,0.217732,0.217997,0.217732,0.216935,0.215605,0.213739,0.211332,0.208377,0.204869,0.200796,0.196149,0.190913,0.185072,0.178607,0.171494,0.163707,0.155211,0.145964,0.135915,0.124997,0.113126,0.100183,0.0860026,0.0703312,0.0527346,0.032304,0.00560381,0.0179387,0.0288368,0.0364485,0.0421891,0.0466643,0.0502075,0.0530278,0.0552678,0.0570307,0.0583943,0.0594192,0.0601541,0.0606387,0.0609061,0.0609841,0.0608966,0.0606642,0.0603048,0.059834,0.0592657,0.0586121,0.0578843,0.0570918,0.0562434,0.0553471,0.0544098,0.0534379,0.0524371,0.0514127,0.0503693,0.0493113,0.0482423,0.047166,0.0460853,0.0450032,0.0439223,0.0428447,0.0417726,0.0407078,0.039652,0.0386067,0.0375732,0.0365526,0.0355459,0.0345542,0.033578,0.0326183,0.0316754,0.0307499,0.0298422,0.0289526,0.0280815,0.0272289,0.026395,0.02558,0.0247838,0.0240064,0.0232479,0.0225081,0.0217869,0.0210841,0.0203997,0.0197334,0.0190849,0.0184541,0.0178407,0.0172445,0.0166652,0.0161024,0.015556,0.0150255,0.0145107,0.0140112,0.0135268,0.0130572];
% waterfilling
figure
y1 = 90/(120*pi)^2/(2*pi)./y.^2;
plot(x,y1,'-.','Linewidth',1.5,'markersize',5,'color','blue');
grid on
xlabel('wavenumber $\kappa$','Interpreter','latex','FontSize',14);
ylabel('best spatial spectrum density','Interpreter','latex','FontSize',14);
axis([-5 5 0 1]);
hold on
y2 = y1;
y2 = min(y2,0.4*ones(1,length(y2)));
plot(x,0.4-y2,'-','Linewidth',1.5,'markersize',5,'color','red');
grid on
xlabel('wavenumber $\kappa$','Interpreter','latex','FontSize',14);
ylabel('best spatial spectrum density','Interpreter','latex','FontSize',14);
text(0,1,'$S_{N}(\kappa)/G(\kappa)^2$','Interpreter','latex','FontSize',14)
text(0,0.5,'$(v-S_{N}(\kappa)/G(\kappa)^2)^+$','Interpreter','latex','FontSize',14)



